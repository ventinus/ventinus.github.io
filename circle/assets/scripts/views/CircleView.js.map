{"version":3,"sources":["../../../../src/assets/scripts/views/CircleView.js"],"names":[],"mappings":"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","file":"CircleView.js","sourcesContent":["// Dependencies\nimport $ from 'jquery';\nimport 'throttle';\nimport 'transform';\n// import 'hammer';\n// import 'jquery-hammer';\n\n// Local Module Variables\nvar WAIT_TIME, DRAG_END_SPEED = 1500;\nvar DRAG_SPEED = 500;\nvar TIMING_FN = 'ease-out';\n\nvar CLASSES = [\n  '',\n  'circle_position2',\n  'circle_position3',\n  'circle_position4'\n]\n\n// Lower the number, the higher the sensitivity\nvar SENSITIVITY = 3;\n\n// Amount of pixels along the x-axis that causes a quarter rotation\nvar QUARTER_ROTATION = 90 * SENSITIVITY;\n\nexport default class CircleView {\n  constructor(element) {\n    /**\n     * Flag to indicate whether the module has been enabled\n     *\n     * @property isEnabled\n     * @type {Boolean}\n     * @default false\n     */\n    this.isEnabled = false;\n\n    /**\n     * Primary jQuery Element\n     *\n     * @property $element\n     * @type {jQuery}\n     */\n    this.$element = $(element);\n\n    this.currentPosition = 0;\n\n    this.startXCoords = null;\n    \n    this.currentXCoords = null;\n    \n    this.endXCoords = null;\n    \n    this.isDragging = false;\n    \n    this.currentRotation = 0;\n    \n    this.rotateAmount = null;\n\n    this.init();\n  }\n\n  // Alias prototype\n  // var proto = CircleView.prototype;\n\n  /**\n   * Init\n   *\n   * Top level function which kicks off\n   * functionality of the constructor\n   *\n   * @public\n   * @chainable\n   * @method init\n   */\n  init() {\n\n    this.setupHandlers()\n      .createChildren()\n      .onWindowResize()\n      .enable();\n\n    return this;\n  }\n\n  /**\n   * Setup Handlers\n   *\n   * Ensure that the proper context of\n   * 'this' is referenced by event handlers\n   *\n   * @public\n   * @chainable\n   * @method setupHandlers\n   */\n  setupHandlers() {\n    this.windowResizeHandler = this.onWindowResize.bind(this);\n    this.mouseDownHandler = this.onMouseDown.bind(this);\n    this.mouseMoveHandler = this.onMouseDrag.bind(this);\n    this.mouseUpHandler = this.onMouseUp.bind(this);\n\n    return this;\n  }\n\n  /**\n   * Create Children\n   *\n   * Cache DOM selectors as properties of the\n   * constructor for public use.\n   *\n   * @public\n   * @chainable\n   * @method createChildren\n   */\n  createChildren() {\n    this.$circleMain = this.$element.children();\n    this.$circleItems = this.$circleMain.children();\n\n    return this;\n  }\n\n  /**\n   * Enable\n   *\n   * Event listeners and any other calls required to\n   * make the constructor work properly.\n   *\n   * @public\n   * @chainable\n   * @method enable\n   */\n  enable() {\n    if (this.isEnabled) {\n      return this;\n    }\n\n    this.isEnabled = true;\n\n    window.addEventListener('resize', this.windowResizeHandler);\n    this.$circleMain.on('mousedown', this.mouseDownHandler);\n    window.addEventListener('mousemove', $.throttle(100, this.mouseMoveHandler));\n    window.addEventListener('mouseup', this.mouseUpHandler);\n\n    return this;\n  }\n\n  /**\n   * Disables the view\n   * Tears down any event binding to handlers\n   * Exits early if it is already disabled\n   *\n   * @method disable\n   * @chainable\n   */\n  disable() {\n    if (!this.isEnabled) {\n      return this;\n    }\n\n    this.isEnabled = false;\n\n\n    window.removeEventListener('resize', this.windowResizeHandler);\n    this.$circleMain.off('mousedown', this.mouseDownHandler);\n    window.removeEventListener('mousemove', $.throttle(100, this.mouseMoveHandler));\n    window.removeEventListener('mouseup', this.mouseUpHandler);\n\n\n    return this;\n  }\n\n  /**\n   * Destroys the view\n   * Tears down any events, handlers, elements\n   * Should be called when the object should be left unused\n   *\n   * @method destroy\n   * @chainable\n   */\n  destroy() {\n    this.disable();\n\n    for (var key in this) {\n      if (this.hasOwnProperty(key)) {\n        this[key] = null;\n      }\n    }\n\n    return this;\n  }\n\n  onMouseDown(event) {\n    this.startXCoords = event.screenX;\n    this.isDragging = true;\n\n    return this;\n  }\n\n  onMouseUp(event) {\n    if (!this.isDragging) {\n      return this;\n    }\n\n    this.isDragging = false;\n    this.endXCoords = event.screenX;\n\n    // If user clicked and did not drag\n    if (this.endXCoords === this.startXCoords) {\n      return this;\n    }\n\n    // Sanitize element of the last class added\n    this.$circleMain.removeClass(CLASSES[this.currentPosition]);\n\n    var remainder = null;\n    // Set remainder to value only for values greater than 90 or lower than -90\n    if (this.rotateAmount < -90 || this.rotateAmount > 90) {\n      remainder = this.rotateAmount % 90;\n    }\n\n    // Find the nearest multiple of 90 and set the rotateAmount and currentRotation to it\n    this.rotateAmount = this.currentRotation = this.getNearestMultiple(remainder);\n\n    // Update styles for position of text items around circle\n    this.updateStyles(DRAG_END_SPEED);\n\n    // Determine which quadrant/position the circle landed\n    this.getQuadrant();\n\n    // Set class of current position\n    this.$circleMain.addClass(CLASSES[this.currentPosition]);\n\n    return this;\n  }\n\n  getNearestMultiple(remainder) {\n    var nearestMultiple = null;\n    if (!remainder) {\n      if (this.rotateAmount >= -45 && this.rotateAmount <= 45) {\n        nearestMultiple = 0;\n      } else {\n        nearestMultiple = this.rotateAmount < -45 ? -90 : 90;\n      }\n    } else if (remainder < 0) {\n      nearestMultiple = remainder >= -45 ? this.rotateAmount - remainder : this.rotateAmount - (90 + remainder);\n    } else if (remainder > 0) {\n      nearestMultiple = remainder <= 45 ? this.rotateAmount - remainder : this.rotateAmount + (90 - remainder);\n    }\n\n    return nearestMultiple;\n  }\n\n  onMouseDrag(event) {\n    if (!this.isDragging) {\n      return this;\n    }\n\n    this.currentXCoords = event.screenX;\n    var xDiff = (this.currentXCoords - this.startXCoords) / SENSITIVITY;\n    this.rotateAmount = xDiff + this.currentRotation;\n\n    this.updateStyles(DRAG_SPEED);\n\n    return this;\n  }\n\n  getQuadrant() {\n    var fullDragX = (this.endXCoords - this.startXCoords) + (QUARTER_ROTATION * this.currentPosition);\n\n    var index = Math.round(fullDragX / QUARTER_ROTATION) % 4;\n    if (index < 0) {\n      index = CLASSES.length + index;\n    }\n\n    this.currentPosition = index;\n\n    return this;\n  }\n\n  onWindowResize(event) {\n    var width = this.$circleMain.width();\n    this.$element.css('height', width);\n    this.$circleMain.css('height', width);\n\n    return this;\n  }\n\n  updateStyles(speed) {\n    var circleTransform = 'rotate(' + this.rotateAmount + 'deg)';\n    var circleTransition = 'transform ' + TIMING_FN + ' ' + speed + 'ms';\n\n    var circleYItemTransform = 'translate(-50%, 0) rotate(' + -this.rotateAmount + 'deg)';\n    var circleXItemTransform = 'translate(0, -50%) rotate(' + -this.rotateAmount + 'deg)';\n    var circleItemTransition = 'all ' + TIMING_FN + ' ' + speed + 'ms';\n    \n    $.transform(this.$circleMain, circleTransform, circleTransition);\n    $.transform(this.$circleItems.eq(0), circleYItemTransform, circleItemTransition);\n    $.transform(this.$circleItems.eq(2), circleYItemTransform, circleItemTransition);\n    $.transform(this.$circleItems.eq(1), circleXItemTransform, circleItemTransition);\n    $.transform(this.$circleItems.eq(3), circleXItemTransform, circleItemTransition);\n\n    return this;\n  }\n}\n"]}